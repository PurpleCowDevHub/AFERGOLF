<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Panel de Administración AFERGOLF - Gestión de productos de golf">
  <title>Admin Dashboard - AFERGOLF</title>
  <link rel="icon" type="image/svg+xml" href="../assets/img/Logo.svg">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/pages/admin_dashboard.css" />
  <link rel="stylesheet" href="../assets/css/toast.css">
  
  <!-- Scripts de utilidades y UI -->
  <script src="../assets/js/ui/toast.js" defer></script>
  <script src="../assets/js/utils/helpers.js" defer></script>
  <script src="../assets/js/ui/components.js" defer></script>
  
  <!-- Auth -->
  <script src="../assets/js/auth/auth.js" defer></script>
  
  <!-- Módulos Admin CRUD (cargar en orden de dependencias) -->
  <script src="../assets/js/admin/admin_read.js" defer></script>
  <script src="../assets/js/admin/admin_create.js" defer></script>
  <script src="../assets/js/admin/admin_update.js" defer></script>
  <script src="../assets/js/admin/admin_delete.js" defer></script>
</head>

<body>
  <!-- HEADER ADMINISTRATIVO -->
  <header class="admin-header">
    <div class="admin-header-container">
      <div class="admin-logo">
        <img src="../assets/img/Logo.svg" alt="AFERGOLF Logo" />
      </div>
      
      <div class="admin-header-content">
        <h1 class="admin-title">Panel de Administración</h1>
        <p class="admin-subtitle">Gestión de productos</p>
      </div>
      
      <div class="admin-header-actions">
        <button id="btn-create-product" class="btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Crear Producto
        </button>
        
        <button id="btn-logout" class="btn-logout">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Cerrar Sesión
        </button>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="admin-main">
    <div class="admin-container">

      <!-- Controles de búsqueda y filtros -->
      <section class="dashboard-controls">
        <div class="search-box">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <input type="text" id="search-input" placeholder="Buscar productos...">
        </div>
        
        <div class="filter-box">
          <select id="filter-category">
            <option value="">Todas las categorías</option>
            <option value="palos">Palos</option>
            <option value="bolas">Bolas</option>
            <option value="guantes">Guantes</option>
          </select>
        </div>
        
        <div class="filter-box">
          <select id="filter-brand">
            <option value="">Todas las marcas</option>
            <option value="footjoy">Footjoy</option>
            <option value="callaway">Callaway</option>
            <option value="titleist">Titleist</option>
            <option value="srixon">Srixon</option>
            <option value="cobra">Cobra</option>
            <option value="taylormade">TaylorMade</option>
          </select>
        </div>
      </section>

      <!-- Tabla de productos -->
      <section class="products-section">
        <div class="products-table-wrapper">
          <table class="products-table">
            <thead>
              <tr>
                <th>Imagen</th>
                <th>Referencia</th>
                <th>Nombre</th>
                <th>Categoría</th>
                <th>Marca</th>
                <th>Precio</th>
                <th>Stock</th>
                <th class="actions-header">Acciones</th>
              </tr>
            </thead>
            <tbody id="products-tbody">
              <!-- Los productos se cargarán dinámicamente -->
            </tbody>
          </table>
        </div>

        <!-- Mensaje cuando no hay productos -->
        <div id="empty-state" class="empty-state" style="display: none;">
          <div class="empty-state-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <div class="empty-state-badge">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                <line x1="8" y1="11" x2="14" y2="11"></line>
              </svg>
            </div>
          </div>
          <h3 class="empty-state-title">No se encontraron productos</h3>
          <p class="empty-state-description">No hay productos que coincidan con tu búsqueda o filtros actuales.</p>
          <div class="empty-state-actions">
            <button id="btn-clear-filters" class="btn-secondary">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 6h18"></path>
                <path d="M7 12h10"></path>
                <path d="M10 18h4"></path>
              </svg>
              Limpiar filtros
            </button>
            <button id="btn-create-product-empty" class="btn-primary">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              Crear nuevo producto
            </button>
          </div>
        </div>
      </section>
  </main>

  <!-- MODAL: CREAR/EDITAR/VER PRODUCTO -->
  <div id="product-modal" class="modal">
    <div class="modal-overlay"></div>
    
    <div class="modal-content modal-product-detail">
      <div class="modal-header">
        <h2 id="modal-title">Crear Producto</h2>
        <button id="modal-close" class="modal-close">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <!-- Formulario del producto -->
      <form id="product-form" class="modal-form">
        <input type="hidden" id="product-id">
        
        <div class="product-detail-container">
          
          <!-- Sección de imágenes -->
          <div class="product-images-section">
            <h3 class="section-title">Imágenes del Producto</h3>
            
            <div class="images-layout">
              <!-- Miniaturas verticales -->
              <div class="product-thumbs-vertical">
                <div class="thumb-upload-group">
                  <input type="file" id="product-image-side" accept="image/*" style="display: none;">
                  <div class="thumb-preview-vertical" id="preview-side" data-input="product-image-side">
                    <img src="" alt="Vista lateral" style="display: none;">
                    <span class="preview-placeholder">
                      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                      <span class="thumb-label">Lateral</span>
                    </span>
                  </div>
                </div>

                <div class="thumb-upload-group">
                  <input type="file" id="product-image-top" accept="image/*" style="display: none;">
                  <div class="thumb-preview-vertical" id="preview-top" data-input="product-image-top">
                    <img src="" alt="Vista superior" style="display: none;">
                    <span class="preview-placeholder">
                      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                      <span class="thumb-label">Superior</span>
                    </span>
                  </div>
                </div>

                <div class="thumb-upload-group">
                  <input type="file" id="product-image-front" accept="image/*" style="display: none;">
                  <div class="thumb-preview-vertical" id="preview-front" data-input="product-image-front">
                    <img src="" alt="Vista frontal" style="display: none;">
                    <span class="preview-placeholder">
                      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                      <span class="thumb-label">Frontal</span>
                    </span>
                  </div>
                </div>
              </div>

              <!-- Imagen principal -->
              <div class="product-main-image">
                <input type="file" id="product-image-main" accept="image/*" required style="display: none;">
                <div class="main-image-preview" id="preview-main" data-input="product-image-main">
                  <img src="" alt="Vista previa principal" style="display: none;">
                  <span class="preview-placeholder">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                      <circle cx="8.5" cy="8.5" r="1.5"></circle>
                      <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <span>Haz clic para seleccionar imagen principal</span>
                  </span>
                </div>
              </div>
            </div>
          </div>

          <!-- Información del producto -->
          <div class="product-info-section">
            <h3 class="section-title">Información del Producto</h3>
            
            <div class="form-group">
              <label for="product-name">Nombre del Producto *</label>
              <input type="text" id="product-name" required maxlength="50" placeholder="Ej: Hammer X Dr. Sandtrap Wedge De Golf De 60 Grados">
              <span class="char-counter" id="product-name-counter">50 caracteres restantes</span>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="product-category">Categoría *</label>
                <select id="product-category" required>
                  <option value="">Seleccionar...</option>
                  <option value="palos">Palos</option>
                  <option value="bolas">Bolas</option>
                  <option value="guantes">Guantes</option>
                </select>
              </div>

              <div class="form-group">
                <label for="product-brand">Marca *</label>
                <select id="product-brand" required>
                  <option value="">Seleccionar...</option>
                  <option value="footjoy">Footjoy</option>
                  <option value="callaway">Callaway</option>
                  <option value="titleist">Titleist</option>
                  <option value="srixon">Srixon</option>
                  <option value="cobra">Cobra</option>
                  <option value="taylormade">TaylorMade</option>
                  <option value="ping">PING</option>
                  <option value="hammerx">Hammer X</option>
                  <option value="otro">Otro</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label for="product-model">Modelo</label>
              <input type="text" id="product-model" placeholder="Ej: B0D562R3XQ">
            </div>

            <!-- Campos dinámicos según categoría -->
            <div id="dynamic-fields">
              
              <!-- Campos para Palos -->
              <div class="category-fields" data-category="palos" style="display: none;">
                <label class="specs-label">Especificaciones del Palo</label>
                
                <div class="specs-grid">
                  <div class="form-group">
                    <label for="product-longitud">Longitud (pulgadas)</label>
                    <input type="number" step="0.25" min="0" id="product-longitud" placeholder="45">
                  </div>
                  <div class="form-group">
                    <label for="product-loft">Loft (°)</label>
                    <input type="number" step="0.5" min="0" max="64" id="product-loft" placeholder="10.5">
                  </div>
                  <div class="form-group">
                    <label for="product-lie">Lie (°)</label>
                    <input type="number" step="0.5" min="0" max="80" id="product-lie" placeholder="58">
                  </div>
                </div>
                
                <div class="specs-grid">
                  <div class="form-group">
                    <label for="product-peso">Peso total (g)</label>
                    <input type="number" step="1" min="0" id="product-peso" placeholder="310">
                  </div>
                  <div class="form-group">
                    <label for="product-swingweight">Swingweight</label>
                    <input type="text" id="product-swingweight" placeholder="D2" maxlength="3">
                  </div>
                  <div class="form-group">
                    <label for="product-flex">Flex de varilla</label>
                    <select id="product-flex">
                      <option value="">Seleccionar...</option>
                      <option value="L">L - Ladies</option>
                      <option value="A">A - Senior</option>
                      <option value="R">R - Regular</option>
                      <option value="S">S - Stiff</option>
                      <option value="X">X - Extra Stiff</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Campos para Guantes -->
              <div class="category-fields" data-category="guantes" style="display: none;">
                <label class="sizes-label">Stock por Talla *</label>
                <div class="sizes-grid">
                  <div class="form-group">
                    <label for="stock-size-s">Talla S</label>
                    <input type="number" id="stock-size-s" min="0" placeholder="0">
                  </div>
                  <div class="form-group">
                    <label for="stock-size-m">Talla M</label>
                    <input type="number" id="stock-size-m" min="0" placeholder="0">
                  </div>
                  <div class="form-group">
                    <label for="stock-size-l">Talla L</label>
                    <input type="number" id="stock-size-l" min="0" placeholder="0">
                  </div>
                  <div class="form-group">
                    <label for="stock-size-xl">Talla XL</label>
                    <input type="number" id="stock-size-xl" min="0" placeholder="0">
                  </div>
                  <div class="form-group">
                    <label for="stock-size-xxl">Talla XXL</label>
                    <input type="number" id="stock-size-xxl" min="0" placeholder="0">
                  </div>
                </div>
              </div>

              <!-- Campos para Bolas -->
              <div class="category-fields" data-category="bolas" style="display: none;">
                <div class="form-group">
                  <label for="product-units">Unidades por paquete</label>
                  <input type="number" id="product-units" placeholder="12">
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="product-price">Precio (COP) *</label>
                <input type="number" id="product-price" required min="0" step="1000" placeholder="125000">
              </div>

              <div class="form-group stock-field-general" id="stock-field-general">
                <label for="product-stock">Stock *</label>
                <input type="number" id="product-stock" required min="0" placeholder="15">
              </div>
            </div>

            <div class="form-group">
              <label for="product-description">Descripción Completa</label>
              <textarea id="product-description" rows="5" placeholder="Descripción detallada del producto..."></textarea>
            </div>
          </div>
        </div>

        <!-- Botones de acción -->
        <div class="modal-actions">
          <button type="submit" class="btn-primary">
            <span id="btn-submit-text">Guardar Producto</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL: CONFIRMAR ELIMINACIÓN -->
  <div id="delete-modal" class="modal">
    <div class="modal-overlay"></div>
    
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h2>Confirmar Eliminación</h2>
      </div>
      
      <div class="modal-body">
        <p>¿Estás seguro de que deseas eliminar este producto?</p>
        <p class="text-warning"><strong>Esta acción no se puede deshacer.</strong></p>
      </div>
      
      <div class="modal-actions">
        <button type="button" id="btn-cancel-delete" class="btn-secondary">Cancelar</button>
        <button type="button" id="btn-confirm-delete" class="btn-danger">Eliminar Producto</button>
      </div>
    </div>
  </div>

  <!-- MODAL: CONFIRMAR CERRAR SESIÓN -->
  <div id="logout-modal" class="modal">
    <div class="modal-overlay"></div>
    
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h2>Cerrar Sesión</h2>
      </div>
      
      <div class="modal-body">
        <p>¿Estás seguro de que deseas cerrar sesión?</p>
        <p class="text-info"><strong>Tendrás que iniciar sesión nuevamente para acceder al panel de administración.</strong></p>
      </div>
      
      <div class="modal-actions">
        <button type="button" id="btn-cancel-logout" class="btn-secondary">Cancelar</button>
        <button type="button" id="btn-confirm-logout" class="btn-danger">Cerrar Sesión</button>
      </div>
    </div>
  </div>

  <!-- MODAL: VISTA PREVIA DE PRODUCTO (COMO LO VE EL CLIENTE) -->
  <div id="product-details-modal" class="modal">
    <div class="modal-overlay"></div>
    
    <div class="modal-content modal-product-preview">
      <div class="modal-header">
        <h2 id="product-details-title">Vista Previa del Producto</h2>
        <button id="product-details-close" class="modal-close">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <!-- Contenido del producto (mismo layout que el formulario admin) -->
      <div class="product-detail-container">
        
        <!-- Sección de imágenes -->
        <div class="product-images-section">
          <div class="images-layout">
            <!-- Miniaturas verticales -->
            <div class="product-thumbs-vertical">
              <div class="thumb-upload-group">
                <div class="thumb-preview-vertical" id="preview-side-details">
                  <img src="" alt="Vista lateral" style="display: none;">
                  <span class="preview-placeholder">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                      <circle cx="8.5" cy="8.5" r="1.5"></circle>
                      <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <span class="thumb-label">Lateral</span>
                  </span>
                </div>
              </div>

              <div class="thumb-upload-group">
                <div class="thumb-preview-vertical" id="preview-top-details">
                  <img src="" alt="Vista superior" style="display: none;">
                  <span class="preview-placeholder">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                      <circle cx="8.5" cy="8.5" r="1.5"></circle>
                      <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <span class="thumb-label">Superior</span>
                  </span>
                </div>
              </div>

              <div class="thumb-upload-group">
                <div class="thumb-preview-vertical" id="preview-front-details">
                  <img src="" alt="Vista frontal" style="display: none;">
                  <span class="preview-placeholder">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                      <circle cx="8.5" cy="8.5" r="1.5"></circle>
                      <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <span class="thumb-label">Frontal</span>
                  </span>
                </div>
              </div>
            </div>

            <!-- Imagen principal -->
            <div class="product-main-image">
              <div class="main-image-preview" id="preview-main-details">
                <img src="" alt="Vista previa principal" style="display: none;">
                <span class="preview-placeholder">
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                  </svg>
                  <span>Imagen principal del producto</span>
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Información del producto -->
        <div class="product-info-section">
          <div class="product-details-info" id="product-details-info-container">
            <h1 class="product-title-details" id="product-name-details">Nombre del Producto</h1>
            
            <!-- Badge de categoría -->
            <span class="category-badge" id="product-category-badge">Categoría</span>
            
            <!-- Información común -->
            <ul class="product-meta-details" id="product-meta-common">
              <li><b>Marca:</b> <span id="product-brand-details">-</span></li>
              <li><b>Modelo:</b> <span id="product-model-details">-</span></li>
              <li><b>Ref:</b> <span id="product-reference-details">-</span></li>
            </ul>
            
            <!-- Información específica por categoría (se llena dinámicamente) -->
            <div class="product-category-specs" id="product-category-specs">
              <!-- Se genera desde JS según la categoría -->
            </div>
            
            <!-- Stock -->
            <div class="product-stock-info" id="product-stock-container">
              <span class="stock-label">Stock:</span>
              <span class="stock-value" id="product-stock-details">0</span>
            </div>
            
            <p class="product-price-details" id="product-price-details">$0 COP</p>
          </div>

        </div>
      </div>
      
      <!-- Descripción completa -->
      <div class="product-description-details">
        <h4>Descripción</h4>
        <p id="product-description-text-details">
          Descripción del producto...
        </p>
      </div>

      <!-- Botones de acción -->
      <div class="modal-actions">
        <button type="button" id="btn-close-preview" class="btn-primary">
          <span>Cerrar</span>
        </button>
      </div>
    </div>
  </div>
</body>
</html>
